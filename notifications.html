<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Notifications</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-2xl mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Your Notifications</h1>
    <div id="notificationsList" class="space-y-4">
      <!-- Notifications will appear here -->
    </div>
  </div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Format timestamp
    function formatTimestamp(timestamp) {
      if (!timestamp) return "";
      const date = timestamp.toDate();
      return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
    }

    // Load notifications
    auth.onAuthStateChanged(user => {
      if (user) {
        db.collection("notifications")
          .where("userId", "==", user.uid)
          .orderBy("timestamp", "desc")
          .onSnapshot(snapshot => {
            const list = document.getElementById("notificationsList");
            list.innerHTML = "";

            if (snapshot.empty) {
              list.innerHTML = `<p class="text-gray-500">No notifications yet.</p>`;
              return;
            }

            snapshot.forEach(doc => {
              const notif = doc.data();
              const item = document.createElement("div");
              item.className = "bg-white p-4 rounded shadow";

              item.innerHTML = `
                <p class="font-medium">${notif.message || "New notification"}</p>
                <p class="text-sm text-gray-500">${formatTimestamp(notif.timestamp)}</p>
              `;
              list.appendChild(item);
            });
          }, error => {
            console.error("Error fetching notifications:", error);
            document.getElementById("notificationsList").innerHTML =
              `<p class="text-red-500">Error loading notifications.</p>`;
          });
      } else {
        document.getElementById("notificationsList").innerHTML =
          `<p class="text-gray-500">You must be logged in to see notifications.</p>`;
      }
    });
  </script>
</body>
</html>
